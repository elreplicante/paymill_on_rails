== Paymill on Rails 4.0.1 {<img src="https://gemnasium.com/lgs/paymill-on-rails.png" alt="Dependency Status" />}[https://gemnasium.com/lgs/paymill-on-rails] {<img src="https://codeclimate.com/github/lgs/paymill-on-rails.png" />}[https://codeclimate.com/github/lgs/paymill-on-rails]


Paymill subscriptions on Rails 4.0.1 and ruby-2.0.0-p247, {deployed on Heroku}[https://paymill-on-rails.herokuapp.com]. 

This code is adapted from {Railscast #288}[http://railscasts.com/episodes/288-billing-with-stripe] [Billing with Stripe] and based on ruby wrapper for the Paymill API gem {paymill-ruby}[https://github.com/dkd/paymill-ruby]

See also Paymill API reference:  {PAYMILL API/V2 DOCUMENTATION}[https://www.paymill.com/en-gb/documentation-3/reference/api-reference/index.html]

== Security Standards

Important information for the credit card data in your HTML form:

With the payment form, it is essential that you do not put a name attribute with the <input> tags for credit card data!

In this way, the credit card data will not be returned to your server, and you will stay outside the legal provisions concerning the storage of such data (PCI compliance).

The only data which Paymill on Rails stores locally infact, are Plans and Subscriptions, which are not sensible and absolutely PCI compliance.

See current Paymill on Rails Model Diagrams:

{<img src="https://raw.github.com/lgs/paymill-on-rails/master/PaymillonRails-Model-Diagrams.jpg" alt="Paymill on Rails Model Diagrams" />}[https://raw.github.com/lgs/paymill-on-rails/master/PaymillonRails-Model-Diagrams.jpg]
 
For further reading see also {payment form}[https://paymill.com/en-gb/documentation-3/introduction/payment-form/] and {security standards}[https://paymill.com/en-gb/support-3/security/security-standards/]

== Usage

Register for a test account at {paymill.com}[https://paymill.com/] and create the subscription plans, also called Offers.

Setup the app:

    $ git clone https://github.com/lgs/paymill-on-rails.git
    $ cd paymill-on-rails
    $ bundle
    $ rake db:migrate
    
    
Replace the test keys in 

   config/initializers/paymill.rb 

for your own paymill API keys.

To get the plans and their IDs from paymill into the app run:

    $ rake paymill:import_plans

That's it! Run 

    $ rails server

and it should work.

== Deploy on Heroku

From rails app's root directory path run 

   $ heroku config:add BUNDLE_WITHOUT="development:test"
   $ heroku rake db:migrate
   $ heroku rake paymill:import_plans

== Current Bundle

GEM
  remote: https://rubygems.org/
  specs:
    actionmailer (4.0.1)
      actionpack (= 4.0.1)
      mail (~> 2.5.4)
    actionpack (4.0.1)
      activesupport (= 4.0.1)
      builder (~> 3.1.0)
      erubis (~> 2.7.0)
      rack (~> 1.5.2)
      rack-test (~> 0.6.2)
    activemodel (4.0.1)
      activesupport (= 4.0.1)
      builder (~> 3.1.0)
    activerecord (4.0.1)
      activemodel (= 4.0.1)
      activerecord-deprecated_finders (~> 1.0.2)
      activesupport (= 4.0.1)
      arel (~> 4.0.0)
    activerecord-deprecated_finders (1.0.3)
    activesupport (4.0.1)
      i18n (~> 0.6, >= 0.6.4)
      minitest (~> 4.2)
      multi_json (~> 1.3)
      thread_safe (~> 0.1)
      tzinfo (~> 0.3.37)
    arel (4.0.1)
    atomic (1.1.14)
    builder (3.1.4)
    coffee-rails (4.0.1)
      coffee-script (>= 2.2.0)
      railties (>= 4.0.0, < 5.0)
    coffee-script (2.2.0)
      coffee-script-source
      execjs
    coffee-script-source (1.6.3)
    erubis (2.7.0)
    execjs (2.0.2)
    hike (1.2.3)
    i18n (0.6.5)
    jbuilder (1.5.2)
      activesupport (>= 3.0.0)
      multi_json (>= 1.2.0)
    jquery-rails (3.0.4)
      railties (>= 3.0, < 5.0)
      thor (>= 0.14, < 2.0)
    json (1.8.1)
    mail (2.5.4)
      mime-types (~> 1.16)
      treetop (~> 1.4.8)
    mime-types (1.25)
    minitest (4.7.5)
    multi_json (1.8.2)
    paymill (0.4.0)
      json
    pg (0.17.0)
    polyglot (0.3.3)
    rack (1.5.2)
    rack-test (0.6.2)
      rack (>= 1.0)
    rails (4.0.1)
      actionmailer (= 4.0.1)
      actionpack (= 4.0.1)
      activerecord (= 4.0.1)
      activesupport (= 4.0.1)
      bundler (>= 1.3.0, < 2.0)
      railties (= 4.0.1)
      sprockets-rails (~> 2.0.0)
    railties (4.0.1)
      actionpack (= 4.0.1)
      activesupport (= 4.0.1)
      rake (>= 0.8.7)
      thor (>= 0.18.1, < 2.0)
    rake (10.1.0)
    rdoc (3.12.2)
      json (~> 1.4)
    sass (3.2.12)
    sass-rails (4.0.1)
      railties (>= 4.0.0, < 5.0)
      sass (>= 3.1.10)
      sprockets-rails (~> 2.0.0)
    sdoc (0.3.20)
      json (>= 1.1.3)
      rdoc (~> 3.10)
    sprockets (2.10.0)
      hike (~> 1.2)
      multi_json (~> 1.0)
      rack (~> 1.0)
      tilt (~> 1.1, != 1.3.0)
    sprockets-rails (2.0.1)
      actionpack (>= 3.0)
      activesupport (>= 3.0)
      sprockets (~> 2.8)
    thor (0.18.1)
    thread_safe (0.1.3)
      atomic
    tilt (1.4.1)
    treetop (1.4.15)
      polyglot
      polyglot (>= 0.3.1)
    turbolinks (1.3.0)
      coffee-rails
    twitter-bootstrap-rails (2.2.8)
      actionpack (>= 3.1)
      execjs
      rails (>= 3.1)
      railties (>= 3.1)
    tzinfo (0.3.38)
    uglifier (2.3.0)
      execjs (>= 0.3.0)
      json (>= 1.8.0)

PLATFORMS
  ruby 2.0.0

DEPENDENCIES
  coffee-rails
  jbuilder (~> 1.2)
  jquery-rails
  paymill
  pg
  rails
  sass-rails
  sdoc
  turbolinks
  twitter-bootstrap-rails
  uglifier

== Related works

See {apalancat}[https://github.com/apalancat] gem {paymill-rails}[https://github.com/apalancat/paymill-rails], more in general see the {Search repository results on github}[https://github.com/search?q=paymill&ref=cmdform]

== Copyright

(The MIT License)

Copyright (c) 2013 Luca G. Soave

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the 'Software'), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
