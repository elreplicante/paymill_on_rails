<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Paymill on rails : Paymill subscriptions with Rails 4.0.1" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Paymill on rails</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/lgs/paymill_on_rails">View on GitHub</a>

          <h1 id="project_title">Paymill on rails</h1>
          <h2 id="project_tagline">Paymill subscriptions with Rails 4.0.1</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/lgs/paymill_on_rails/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/lgs/paymill_on_rails/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="paymillonrails" class="anchor" href="#paymillonrails"><span class="octicon octicon-link"></span></a>PaymillOnRails</h1>

<p><a href="https://gemnasium.com/lgs/paymill_on_rails"><strong><img src="https://gemnasium.com/lgs/paymill_on_rails.png" alt="Dependency Status"></strong></a> <a href="https://codeclimate.com/github/lgs/paymill-on-rails"><strong><img src="https://codeclimate.com/github/lgs/paymill_on_rails.png"></strong></a></p>

<p>Paymill subscriptions on Rails 4.0.1 and ruby-2.0.0-p247, <a href="https://paymill-on-rails.herokuapp.com"><strong>deployed on Heroku</strong></a>. This code is adapted from <a href="http://railscasts.com/episodes/288-billing-with-stripe"><strong>Railscast #288</strong></a> and based on ruby wrapper for the Paymill API gem <a href="https://github.com/dkd/paymill-ruby"><strong>paymill-ruby</strong></a>. See also Paymill API reference:  <a href="https://www.paymill.com/en-gb/documentation-3/reference/api-reference/index.html"><strong>Paymill API/v2 documentation</strong></a></p>

<h2>
<a name="security-standards" class="anchor" href="#security-standards"><span class="octicon octicon-link"></span></a>Security Standards</h2>

<p>Important information for the credit card data in your HTML form:</p>

<p>With the payment form, it is essential that you do not put a name attribute with the  tags for credit card data! In this way, the credit card data will not be returned to your server, and you will stay outside the legal provisions concerning the storage of such data (<a href="http://en.wikipedia.org/wiki/Payment_Card_Industry_Data_Security_Standard"><strong>PCI compliance</strong></a>). The only data which Paymill on Rails stores locally infact, are Plans and Subscriptions, which are not sensible and absolutely <a href="http://en.wikipedia.org/wiki/Payment_Card_Industry_Data_Security_Standard"><strong>PCI compliant</strong></a>.</p>

<p>See current Paymill on Rails data model </p>

<pre><code>  ActiveRecord::Schema.define(version: 20121207103300) do

    create_table "plans", force: true do |t|
      t.string "paymill_id"
      t.string "name"
      t.float "price"
      t.datetime "created_at"
      t.datetime "updated_at"
    end

    create_table "subscriptions", force: true do |t|
      t.integer "plan_id"
      t.string "email"
      t.string "name"
      t.string "paymill_id"
      t.datetime "created_at"
      t.datetime "updated_at"
    end

  end
</code></pre>

<p>For further reading see also <a href="https://paymill.com/en-gb/documentation-3/introduction/payment-form"><strong>payment form</strong></a> and <a href="https://paymill.com/en-gb/support-3/security/security-standards"><strong>security standards</strong></a></p>

<h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<p>Since the release of <a href="https://rubygems.org/gems/paymill_on_rails"><strong>paymill_on_rails gem 0.0.5</strong></a>, PaymillOnRails becomes a <a href="http://edgeguides.rubyonrails.org/engines.html"><strong>Mountable Rails Engines</strong></a> for Rails 4. Set up a subscription payment integrating it with your existing Rails application service is now very simple just following nex steps:</p>

<ul>
<li><p>register for a test account at <a href="https://paymill.com"><strong>paymill.com</strong></a> and create the subscription plans, also called Offers (<a href="https://app.paymill.com/en-gb#!/offers"><strong>read more</strong></a>, which are how Subscription Plans are called in Paymill. </p></li>
<li><p>build a new Rails app from scratch (or use your existing one) :</p></li>
</ul><pre><code>$ rails new myapp &amp;&amp; myapp
$ echo "gem 'paymill_on_rails' &gt;&gt; Gemfile
$ bundle update
$ rake paymill_on_rails:install:migrations
$ rake db:migrate
</code></pre>

<ul>
<li>now mount the engine adding the following to config/routes.rb :</li>
</ul><pre><code>  Prova::Application.routes.draw do
     root 'paymill_on_rails/plans#index' #(or use another path)
     mount PaymillOnRails::Engine =&gt; "/paymill_on_rails"
  end
</code></pre>

<ul>
<li><p>Login in with your Paymill account and follow <a href="https://app.paymill.com/en-gb#!/index"><strong>Dasboard --&gt; My Account --&gt; Settings --&gt; APY Keys</strong></a>, to see your keys and set PAYMILL_PUBLIC_KEY/API_KEY accordingly. </p></li>
<li><p>set OS env variables, with your own paymill test keys :</p></li>
</ul><pre><code>   $ env | grep _KEY
   PAYMILL_PUBLIC_KEY=11111111111111111111111
   API_KEY=a1b2c3d4e5f6g7h8i9l1i2m3
</code></pre>

<ul>
<li>get the plans and their IDs from paymill :</li>
</ul><pre><code>    $ rake paymill_on_rails:import_plans
</code></pre>

<p>That's it! Run </p>

<pre><code>    $ rails server
</code></pre>

<p>and it should work.</p>

<h2>
<a name="deploy-on-heroku" class="anchor" href="#deploy-on-heroku"><span class="octicon octicon-link"></span></a>Deploy on Heroku</h2>

<p>In your rails app  run </p>

<pre><code>   $ heroku config:add BUNDLE_WITHOUT="development:test"
   $ heroku rake db:migrate
   $ heroku rake paymill_on_rails:import_plans
</code></pre>

<h2>
<a name="current-bundle" class="anchor" href="#current-bundle"><span class="octicon octicon-link"></span></a>Current Bundle</h2>

<p>PATH</p>

<pre><code>  remote: .
  specs:
    paymill_on_rails (0.0.6)
      paymill (~&gt; 0.4.0)
      rails (~&gt; 4.0.0)
</code></pre>

<p>GEM</p>

<pre><code>  remote: https://rubygems.org/
  specs:
    actionmailer (4.0.1)
      actionpack (= 4.0.1)
      mail (~&gt; 2.5.4)
    actionpack (4.0.1)
      activesupport (= 4.0.1)
      builder (~&gt; 3.1.0)
      erubis (~&gt; 2.7.0)
      rack (~&gt; 1.5.2)
      rack-test (~&gt; 0.6.2)
    activemodel (4.0.1)
      activesupport (= 4.0.1)
      builder (~&gt; 3.1.0)
    activerecord (4.0.1)
      activemodel (= 4.0.1)
      activerecord-deprecated_finders (~&gt; 1.0.2)
      activesupport (= 4.0.1)
      arel (~&gt; 4.0.0)
    activerecord-deprecated_finders (1.0.3)
    activesupport (4.0.1)
      i18n (~&gt; 0.6, &gt;= 0.6.4)
      minitest (~&gt; 4.2)
      multi_json (~&gt; 1.3)
      thread_safe (~&gt; 0.1)
      tzinfo (~&gt; 0.3.37)
    arel (4.0.1)
    atomic (1.1.14)
    builder (3.1.4)
    erubis (2.7.0)
    hike (1.2.3)
    i18n (0.6.5)
    json (1.8.1)
    mail (2.5.4)
      mime-types (~&gt; 1.16)
      treetop (~&gt; 1.4.8)
    mime-types (1.25)
    minitest (4.7.5)
    multi_json (1.8.2)
    paymill (0.4.0)
      json
    polyglot (0.3.3)
    rack (1.5.2)
    rack-test (0.6.2)
      rack (&gt;= 1.0)
    rails (4.0.1)
      actionmailer (= 4.0.1)
      actionpack (= 4.0.1)
      activerecord (= 4.0.1)
      activesupport (= 4.0.1)
      bundler (&gt;= 1.3.0, &lt; 2.0)
      railties (= 4.0.1)
      sprockets-rails (~&gt; 2.0.0)
    railties (4.0.1)
      actionpack (= 4.0.1)
      activesupport (= 4.0.1)
      rake (&gt;= 0.8.7)
      thor (&gt;= 0.18.1, &lt; 2.0)
    rake (10.1.0)
    sprockets (2.10.0)
      hike (~&gt; 1.2)
      multi_json (~&gt; 1.0)
      rack (~&gt; 1.0)
      tilt (~&gt; 1.1, != 1.3.0)
    sprockets-rails (2.0.1)
      actionpack (&gt;= 3.0)
      activesupport (&gt;= 3.0)
      sprockets (~&gt; 2.8)
    sqlite3 (1.3.8)
    thor (0.18.1)
    thread_safe (0.1.3)
      atomic
    tilt (1.4.1)
    treetop (1.4.15)
      polyglot
      polyglot (&gt;= 0.3.1)
    tzinfo (0.3.38)
</code></pre>

<p>PLATFORMS</p>

<pre><code>  ruby 2.0.0
</code></pre>

<p>DEPENDENCIES</p>

<pre><code>  paymill_on_rails!
  sqlite3
</code></pre>

<h2>
<a name="related-works" class="anchor" href="#related-works"><span class="octicon octicon-link"></span></a>Related works</h2>

<p>See <a href="https://github.com/apalancat"><strong>apalancat</strong></a> gem <a href="https://github.com/apalancat/paymill-rails"><strong>paymill-rails</strong></a>. More in general see the <a href="https://github.com/search?l=Ruby&amp;q=paymill&amp;ref=cmdform&amp;type=Repositories"><strong>Search repository results on github</strong></a>.</p>

<h2>
<a name="copyright" class="anchor" href="#copyright"><span class="octicon octicon-link"></span></a>Copyright</h2>

<p>(The MIT License)</p>

<p>Copyright (c) 2013 Luca G. Soave</p>

<p>Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the 'Software'), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:</p>

<p>The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.</p>

<p>THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Paymill on rails maintained by <a href="https://github.com/lgs">lgs</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-2914610-10");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>


  </body>
</html>
